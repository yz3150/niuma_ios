/// æ‘¸é±¼æ”¶å…¥æ¡£ä½åŠå¯¹åº”æ–‡æ¡ˆåˆ—è¡¨
final Map<int, List<String>> restEarningsMessages = {
  0: [
    "æ­å–œè§£é”æ‘¸é±¼ç•Œé’é“œé€‰æ‰‹ï¼è¿™ç‚¹é’±åˆšå¥½ä¹°åŒ…è¾£æ¡è¡¥å……æˆ˜æ–—åŠ›ğŸŒ¶ï¸",
    "ç³»ç»Ÿæ£€æµ‹åˆ°æ‚¨å·²èµšå›ä»Šæ—¥å·¥ä½ç”µè´¹ï¼è¯·ç»§ç»­ä¿æŒå…‰åˆä½œç”¨çŠ¶æ€ğŸ”‹",
    "ğŸ””å®~ æ‚¨çš„ç…é¥¼åŸºé‡‘å·²è¦†ç›–è‘±èŠ±è‡ªç”±ï¼Œä¸‹ä¸€æ­¥è§£é”ç«è…¿è‚ VIPç‰¹æƒï¼",
    "æ‘¸é±¼æ”¶ç›Šâ‰ˆè€æ¿æ¯åˆ†é’Ÿå‘¼å¸æŸè€—ï¼Œä½†ä½ çš„æ¯ä¸€ç§’éƒ½åœ¨å¢å€¼ğŸ’°",
    "å†æ‘¸5åˆ†é’Ÿï¼Œç‘å¹¸å†°å’–é©¬ä¸Šåˆ°è´¦âœ¨",
    "è€æ¿çš„å¿ƒç—›å¤šè·³ä¸€æ¬¡ï¼Œæ‚¨çš„èœœé›ªå†°åŸåœ£ä»£å°±å¤šåŠ é¢—è‰è“ğŸ“"
  ],
  10: [
    "10å…ƒåˆ°è´¦ï¼ç›¸å½“äºç”¨è€æ¿çš„A4çº¸æŠ˜äº†è‰˜é»„é‡‘èˆ¹ğŸš¢",
    "æ¸©é¦¨æç¤ºï¼šå½“å‰ä½™é¢å¯å…‘æ¢å¥¶èŒ¶åº—ğŸ§‹è‚¡ä¸œä½“éªŒå¡ï¼ˆé™æ—¶30ç§’ï¼‰",
    "æ­å–œå‡»è´¥å…¨å›½88%çš„å¸¦è–ªå‘å‘†ç”¨æˆ·ï¼åŠ æŠŠåŠ²è§£é”è–¯æ¡åŠ è´­æƒğŸŸ",
    "æ¸©é¦¨æç¤ºï¼šç°åœ¨æ”¾å¼ƒ=è‡ªæ„¿æˆä¸ºè€æ¿æ–°è½¦çš„èºä¸é’‰ğŸ”©"
  ],
  18: [
    "æ‘¸é±¼èƒ½é‡å……èƒ½98%ï¼å·®2å…ƒå³å¯å‘å°„ã€å’–å•¡å› æ‹¯æ•‘ä¸–ç•Œã€è®¡åˆ’â˜•",
    "ä»èµ„æœ¬å®¶æŒ‡ç”²ç¼é‡ŒæŠ å‡ºä¸ªæ˜Ÿå·´å…‹ä¸­æ¯ï¼",
    "å½“ä»£èŒåœºç¤¼ä»ªï¼šç”¨æ‘¸é±¼é’±ä¹°å’–å•¡ï¼Œç»­å‘½ç»§ç»­å¸®è€æ¿åœ†è°â˜•ï¸",
    "è§£é”æ‘¸é±¼å­¦æ–°æˆå°±ï¼šç”¨å…¬å¸ç”µè´¹èµšå¤Ÿå¥¶èŒ¶é’±ï¼ˆåŠŸå¾·+1ğŸ™ï¼‰"
  ],
  30: [
    "åŒäº‹åœ¨å·å‘¨æŠ¥ï¼Œæˆ‘åœ¨æ‘¸é±¼ï¼Œæœ€åä»–å¾—è…±é˜ç‚æˆ‘èµšæŒ‰æ‘©è´¹ï¼Œèµ¢ï¼",
    "ğŸŸæ‘¸é±¼æš´å¯Œå…¬å¼ï¼š30å…ƒÃ—22ä¸ªå·¥ä½œæ—¥=è€æ¿ç—›å¤±çˆ±é©¬ä»•çš®å¸¦ä¸€æ¡",
    "æ‚¨å·²è·å¾—ç”µå½±ç¥¨åŠä»·èµ„æ ¼ï¼Œè¯·é€‰æ‹©ï¼šç»§ç»­æ‘¸é±¼ ğŸ†š èµåŠ©è€æ¿åº¦å‡ï¼Ÿ",
    "æ‘¸åˆ°ç‘å¹¸è‡ªç”±ï¼âœŒï¸",
    "æ‰“å·¥æš‚åœï¼å…ˆæ30å—è¯·è‡ªå·±å–ç§‹å¤©çš„ç¬¬ä¸€æ¯å¥¶èŒ¶"
  ],
  50: [
    "æ‘¸å‡ºç”µå½±è‡ªç”±ï¼æœ¬æ¡£å¥–åŠ±å¯é€‰IMAXå½±ç¥¨Ã—2ğŸ¬",
    "æ­å–œçªç ´ç²¾è‹±å…³å¡ï¼50å…ƒå¤Ÿåƒæ—¥æ–™å®šé£Ÿå•¦ğŸ£",
    "è€æ¿åœ¨å¼€ä¼šï¼Ÿå†æ‘¸50åˆ†é’Ÿ=ç™½å¾—æ³¡æ³¡ç›ç‰¹ç›²ç›’ğŸ",
    "æ‘¸é±¼é‡‘å¸+50ï¼å»ºè®®è´­ä¹°ï¼šå¥¶èŒ¶+è›‹ç³•æ²»æ„ˆå¥—é¤ğŸ°",
    "æ‘¸åˆ°50å·¨æ¬¾ï¼å¤Ÿè¯·PMå–å¥¶èŒ¶ğŸ§‹äº†â€”â€”å¦‚æœä»–æ„¿æ„æŠŠéœ€æ±‚åå›å»çš„è¯"
  ],
  100: [
    "æ£€æµ‹åˆ°æ‘¸é±¼æ”¶ç›Šï¼å…¬å¸å›¢å»ºäººå‡ç»è´¹ï¼",
    "ğŸŸæ‘¸é±¼ç»æµå­¦ç¬¬ä¸€è¯¾ï¼šå½“ä½ çš„æ—¶è–ªè¶…è¿‡æ¥¼ä¸‹ä¾¿åˆ©åº—ï¼Œå°±èµ¢äº†ï¼",
    "ç³»ç»Ÿè­¦å‘Šï¼šæ‚¨å·²æŒæ¡ã€ç”¨è€æ¿ç”»çš„é¥¼å°±ç€æ‘¸é±¼é’±ä¸‹é¥­ã€ç”Ÿå­˜æŠ€èƒ½ğŸ«“"
  ],
  200: [
    "æ­å–œæ‘¸å‡ºé©¬å°”ä»£å¤«ç©ºæ°”ï¼å½“å‰ä½™é¢å¯å…‘æ¢0.5ã¡æµ·å²›ä½¿ç”¨æƒğŸŒ´",
    "ğŸ””å®~200å…ƒåˆ°è´¦ï¼å»ºè®®ç”¨é€”ï¼šå‰§æœ¬æ€è½¦é˜Ÿé›†èµ„",
    "æ‘¸é±¼ç‹è€…è¿›åº¦20%ï¼å½“å‰å¤Ÿä¹°3æ”¯YSLå°é‡‘æ¡ğŸ’„",
    "ç³»ç»Ÿæç¤ºï¼šæœ¬æ¡£å¥–åŠ±å¯å…‘æ¢è¿ªå£«å°¼é—¨ç¥¨1/3å¼ ğŸ«",
    "ç´¯è®¡æ—¶é•¿åˆ†æï¼šæ‚¨å·²æ‘¸å‡ºä»·å€¼AirPods Proçš„é›¶èŠ±é’±ğŸ§",
    "200å…ƒ=å¥¶èŒ¶Ã—10æ¯=ç”µå½±Ã—4åœº=ç«é”…Ã—1é¡¿â€¦ä½†æŒç»­æ‘¸é±¼=ALL INğŸ’ª"
  ],
  300: [
    "å†æ‘¸åŠå°æ—¶ï¼ŒSwitchå¡å¸¦ä»»é€‰ä¸‰æ¬¾ä¸æ˜¯æ¢¦ï¼ğŸ®",
    "è¿™ä¸ªæ•°å¤Ÿä¹°æ•´å¥—ç¥ä»™æ°´ï¼Œæ‘¸åˆ°å°±æ˜¯èµšåˆ°ç¾è²Œï¼ğŸ’„",
    "ä¸»å­ç½å¤´è‡ªç”±è¿‘åœ¨çœ¼å‰ï¼Œå–µæ˜Ÿäººå‚¬ä½ ç»§ç»­åˆ’æ°´ï¼ğŸ±",
    "700å…ƒâ‰ˆå¸¦è–ªğŸ’©300æ¬¡çš„å¥–é‡‘ï¼ˆå˜˜ï¼åˆ«è®©è¡Œæ”¿å‘ç°å•æ‰€VIPæ˜¯æ‚¨ï¼‰",
    "æ‘¸é±¼èƒ½é‡+300ï¼æ£€æµ‹åˆ°å¯å…‘æ¢ã€Šè€æ¿ç”»çš„é¥¼çªç„¶ä¸å™äº†ã€‹ä½“éªŒå¡ğŸ•"
  ],
  500: [
    "å½“å‰é‡‘é¢å¯å…¥æ‰‹Switchæ¸¸æˆå¡Ã—3ğŸ®",
    "æ‘¸é±¼ç»æµå­¦ï¼šæ‚¨çš„æ—¶é—´â‰ˆSK-IIç¥ä»™æ°´30mlğŸ’„",
    "ç‰¹åˆ«é€šçŸ¥ï¼šæœ¬æ¡£é‡‘é¢æ”¯æŒåˆ†æœŸè´­ä¹°æ— äººæœºé¦–ä»˜ğŸ›¸",
    "æ‘¸é±¼ç›¸å¯¹è®ºï¼šèµšå¾—è¶Šå¤šï¼Œè¯æ˜ä½ æµªè´¹åœ¨ä¼šè®®ä¸Šçš„ç”Ÿå‘½è¶Šå¤šğŸ¤”"
  ],
  1000: [
    "æ‘¸æ»¡å››ä½æ•°ï¼Œé©¬å°”ä»£å¤«æœºç¥¨é’±å°±æ”’å¤Ÿé›¶å¤´å•¦ï¼âœˆï¸",
    "æ‘¸é±¼ç•Œä¼ è¯´ï¼šå½“é‡‘é¢ç ´åƒæ—¶ï¼Œè€æ¿çš„çœ¼æ³ªä¼šå˜æˆçç å¥¶èŒ¶é‡Œçš„çç ğŸ’§",
    "åšæŒä½ï¼ç‹è€…å…¨çš®è‚¤çš„é’±å¿«æ”’å¤Ÿäº†ï¼ğŸ",
    "å®~æ£€æµ‹åˆ°å¯å…‘æ¢PS5æ•°å­—ç‰ˆï¼Œè¯·æŒç»­æ‘¸é±¼å……èƒ½ğŸ®",
    "åƒå…ƒæˆå°±è¾¾æˆï¼å·²ä¸ºæ‚¨é¢„çº¦Tonyè€å¸ˆæ€»ç›‘çƒ«æŸ“å¥—é¤ğŸ’†â€â™‚ï¸"
  ],
  2000: [
    "2000å…ƒ=48å°æ—¶è¿ªå£«å°¼å°Šäº«å¯¼è§ˆï¼Œç«¥è¯ä¸–ç•Œç­‰ä½ æ‰“å¡ğŸ°",
    "å†æ‘¸ä¸¤è½®ï¼Œswitchå…¨å®¶æ¡¶+å¥èº«ç¯å¥—è£…ç›´æ¥æŠ±èµ°ğŸ®",
    "æ£€æµ‹åˆ°å¯å…‘æ¢ä»»å¤©å ‚è‚¡ç¥¨1è‚¡ï¼Œæˆä¸ºä¸–ç•Œä¸»å®°è‚¡ä¸œğŸ’¼",
    "æ­å–œé›†é½ç¾å®¹ä»ªé¦–ä»˜ï¼é€†é¾„ç”Ÿé•¿ç¨‹åºå·²å¯åŠ¨ğŸ’†â€â™‚ï¸"
  ],
  5000: [
    "æ‘¸é±¼å®—å¸ˆè®¤è¯ï¼å½“å‰å¯å…¨æ¬¾æ‹¿ä¸‹iPhone15ProğŸ’»",
    "ç³»ç»Ÿæ’­æŠ¥ï¼šæ‚¨å·²æ‘¸å‡ºé©¬å°”ä»£å¤«åŒäººæœºç¥¨+1æ™šä½å®¿ğŸï¸",
    "éšè—æˆå°±è¾¾æˆï¼šæ‘¸é±¼æ”¶ç›Šè¶…è¿‡90åå¹³å‡å­˜æ¬¾ğŸ’°",
    "è´¢å¯Œå¯†ç ç ´è¯‘ï¼å½“å‰é‡‘é¢=æ™®é€šäººåŠå¹´å’–å•¡é¢„ç®—ğŸ¥¤",
    "æ­å–œå®Œæˆç»ˆææŒ‘æˆ˜ï¼ä¸‹ä¸€ç›®æ ‡ï¼šæ‘¸å‡ºç‰¹æ–¯æ‹‰é¦–ä»˜ğŸš—",
    "ç»ˆæå“²å­¦ï¼šæ‘¸åˆ°è¿™ä¹ˆå¤šè¿˜æ²¡ç¦»èŒï¼Œè¯´æ˜ä½ å·²ç»å­¦ä¼šä¸è™šæ— å…±èˆğŸ¤”"
  ],
};

// æ·»åŠ ä¸Šæ¬¡æ›´æ–°æ—¶é—´å’Œå½“å‰æ˜¾ç¤ºæ–‡æ¡ˆçš„è®°å½•
DateTime _lastMessageUpdateTime = DateTime(1970); // åˆå§‹åŒ–ä¸ºå¾ˆä¹…ä»¥å‰çš„æ—¶é—´ï¼Œç¡®ä¿ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ä¼šæ›´æ–°
String _currentMessage = "è€æ¿çš„å¿ƒç—›å¤šè·³ä¸€æ¬¡ï¼Œæ‚¨çš„èœœé›ªå†°åŸåœ£ä»£å°±å¤šåŠ é¢—è‰è“ğŸ“";
int? _lastThreshold; // è®°å½•ä¸Šæ¬¡çš„æ”¶å…¥æ¡£ä½

/// è·å–æ‘¸é±¼æ”¶å…¥å¯¹åº”çš„éšæœºæ–‡æ¡ˆ
/// æ¯éš”5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ï¼Œæˆ–è€…å½“æ”¶å…¥æ¡£ä½å˜åŒ–æ—¶æ›´æ–°
String getRandomRestEarningMessage(double restEarning) {
  final now = DateTime.now();
  
  // æŸ¥æ‰¾å½“å‰æ‘¸é±¼æ”¶å…¥å¯¹åº”çš„æ¡£ä½
  int? currentThreshold;
  for (final threshold in restEarningsMessages.keys.toList()..sort()) {
    if (restEarning >= threshold) {
      currentThreshold = threshold;
    } else {
      break;
    }
  }
  
  // è®¡ç®—è·ç¦»ä¸Šæ¬¡æ›´æ–°çš„æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  final minutesSinceLastUpdate = now.difference(_lastMessageUpdateTime).inMinutes;
  
  // åˆ¤æ–­æ˜¯å¦éœ€è¦æ›´æ–°æ–‡æ¡ˆï¼š
  // 1. å·²ç»è¿‡äº†5åˆ†é’Ÿ
  // 2. æ”¶å…¥æ¡£ä½å‘ç”Ÿå˜åŒ–
  // 3. è¿˜æ²¡æœ‰è®¾ç½®è¿‡æ–‡æ¡ˆï¼ˆç¬¬ä¸€æ¬¡è°ƒç”¨ï¼‰
  if (minutesSinceLastUpdate >= 5 || currentThreshold != _lastThreshold || _currentMessage == "è€æ¿çš„å¿ƒç—›å¤šè·³ä¸€æ¬¡ï¼Œæ‚¨çš„èœœé›ªå†°åŸåœ£ä»£å°±å¤šåŠ é¢—è‰è“ğŸ“") {
    // å¦‚æœæ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•æ¡£ä½ï¼Œè¿”å›é»˜è®¤æ–‡æ¡ˆ
    if (currentThreshold == null) {
      _currentMessage = "è€æ¿çš„å¿ƒç—›å¤šè·³ä¸€æ¬¡ï¼Œæ‚¨çš„èœœé›ªå†°åŸåœ£ä»£å°±å¤šåŠ é¢—è‰è“ğŸ“";
    } else {
      // ä»å¯¹åº”æ¡£ä½çš„æ–‡æ¡ˆåˆ—è¡¨ä¸­éšæœºé€‰æ‹©ä¸€æ¡
      final messageList = restEarningsMessages[currentThreshold]!;
      final randomIndex = DateTime.now().millisecondsSinceEpoch % messageList.length;
      _currentMessage = messageList[randomIndex];
    }
    
    // æ›´æ–°ä¸Šæ¬¡æ›´æ–°æ—¶é—´å’Œæ¡£ä½è®°å½•
    _lastMessageUpdateTime = now;
    _lastThreshold = currentThreshold;
  }
  
  // è¿”å›å½“å‰æ–‡æ¡ˆï¼ˆå¯èƒ½æ˜¯åˆšåˆšæ›´æ–°çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¹‹å‰çš„ï¼‰
  return _currentMessage;
} 